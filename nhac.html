<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Music Player - Kang & Thy</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #1a1a1a, #3d002f);
        font-family: 'Segoe UI', sans-serif;
        color: white;
        height: 100vh;
        display: flex;
        overflow: hidden;
    }

    /* V√πng tr√°i ch·ª©a ƒëƒ©a + n√∫t ƒëi·ªÅu khi·ªÉn */
    .left-panel {
        width: 65%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        transition: width 0.3s ease;
    }
    
    /* Khi playlist b·ªã ·∫©n, left-panel chi·∫øm to√†n b·ªô chi·ªÅu r·ªông */
    .left-panel.full-width {
        width: 100%; 
    }

    /* ƒêƒ©a nh·∫°c */
    .disc-container {
        width: 260px;
        height: 260px;
        border-radius: 50%;
        /* L∆ØU √ù QUAN TR·ªåNG: ƒê√£ x√≥a URL ·∫£nh n·ªÅn c·ªë ƒë·ªãnh kh·ªèi CSS */
        background-color: #333; /* M√†u n·ªÅn d·ª± ph√≤ng */
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
        border: 6px solid #ffb6d9;
        box-shadow: 0 0 25px #ff7ac4;
        animation: spin 4s linear infinite;
        animation-play-state: paused;
        /* TH√äM: ƒê·ªÉ chuy·ªÉn ƒë·ªïi ·∫£nh b√¨a c√≥ hi·ªáu ·ª©ng m·ªÅm m·∫°i h∆°n */
        transition: background-image 0.5s ease; 
    }

    .playing .disc-container {
        animation-play-state: running;
    }

    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    /* Ti√™u ƒë·ªÅ b√†i h√°t */
    .song-title {
        margin-top: 20px;
        font-size: 26px;
        font-weight: bold;
        text-align: center;
        color: #ffbde6;
    }

    .song-desc {
        font-size: 14px;
        margin-top: 5px;
        opacity: 0.8;
        text-align: center;
        color: #ffd4ef;
    }

    /* CSS CHO PROGRESS BAR */
    .progress-container {
        width: 70%; 
        max-width: 400px;
        margin-top: 30px;
    }

    .progress-bar {
        height: 8px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        cursor: pointer;
        position: relative;
    }

    .progress {
        height: 100%;
        width: 0%;
        background: #ff4fab;
        border-radius: 4px;
        transition: width 0.1s linear;
    }

    .time-display {
        display: flex;
        justify-content: space-between;
        margin-top: 5px;
        font-size: 12px;
        opacity: 0.7;
    }
    
    /* N√∫t ƒëi·ªÅu khi·ªÉn */
    .controls {
        margin-top: 20px; 
        display: flex;
        gap: 20px;
        align-items: center; 
    }

    .btn {
        width: 55px;
        height: 55px;
        border-radius: 50%;
        background: #ff87c9;
        border: none;
        font-size: 20px;
        cursor: pointer;
        box-shadow: 0 0 15px #ff5bb1;
        transition: 0.2s;
        color: black; /* Th√™m m√†u cho icon ƒë·ªÉ d·ªÖ nh√¨n */
    }

    #playBtn {
        width: 70px; 
        height: 70px;
        font-size: 28px;
    }
    
    #shuffleBtn {
        background: #ff4fab; 
        box-shadow: 0 0 15px #ff4fab;
        font-size: 24px;
    }

    /* TH√äM: CSS cho n√∫t Share l·ªõn */
    #shareBtn {
        font-size: 24px;
    }

    .btn:hover {
        transform: scale(1.15);
        background: #ff4fab;
    }
    
    #shuffleBtn:hover {
        background: #ff3399; 
    }

    /* Playlist b√™n ph·∫£i */
    .playlist {
        width: 35%;
        max-width: 400px; 
        background: rgba(255, 255, 255, 0.06);
        backdrop-filter: blur(10px);
        padding: 25px;
        overflow-y: auto;
        height: 100vh;
        border-left: 2px solid #ff8ccd;
        transition: transform 0.3s ease, width 0.3s ease;
    }
    
    /* Tr·∫°ng th√°i ·∫©n c·ªßa Playlist */
    .playlist.hidden {
        transform: translateX(100%); 
        width: 0;
        padding: 0;
        border-left: none;
        min-width: 0;
    }

    .playlist h2 {
        text-align: center;
        color: #ffbde6;
        margin-bottom: 20px;
    }

    .song-item {
        padding: 12px;
        margin-bottom: 10px;
        background: rgba(255, 182, 213, 0.15);
        border-radius: 10px;
        cursor: pointer;
        transition: 0.2s;
        /* ƒê·∫£m b·∫£o flex ƒë·ªÉ ch·ª©a n√∫t share */
        display: flex; 
        justify-content: space-between;
        align-items: center;
    }
    
    /* V√πng ch·ª©a th√¥ng tin ƒë·ªÉ n√∫t share n·∫±m b√™n ph·∫£i */
    .song-details {
        flex-grow: 1;
    }

    .song-item:hover {
        background: rgba(255, 182, 213, 0.35);
    }

    .active {
        background: #ff7cc2 !important;
    }

    .song-name {
        font-size: 16px;
        font-weight: bold;
    }
    
    /* Th√™m style cho l∆∞·ª£t nghe */
    .song-stats {
        opacity: 0.9;
        font-size: 12px;
        margin-top: 5px;
        color: #ff91c7;
    }

    .song-info {
        opacity: 0.7;
        font-size: 13px;
        margin-top: 3px;
    }
    
    /* TH√äM: Style cho n√∫t Share nh·ªè trong playlist */
    .share-playlist-btn {
        background: none;
        border: none;
        color: black; /* M√†u icon */
        font-size: 18px;
        cursor: pointer;
        padding: 5px;
        margin-left: 10px;
        opacity: 0.8;
        transition: opacity 0.2s, transform 0.2s;
    }

    .share-playlist-btn:hover {
        opacity: 1;
        transform: scale(1.1);
        color: #ff3399;
    }
    
    /* N√∫t ·∫©n/hi·ªán */
    #togglePlaylistBtn {
        position: absolute;
        top: 20px;
        right: 20px; 
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: #ff87c9;
        border: none;
        font-size: 20px;
        cursor: pointer;
        box-shadow: 0 0 10px #ff5bb1;
        transition: 0.2s;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }

    #togglePlaylistBtn:hover {
        transform: scale(1.1);
        background: #ff4fab;
    }

</style>
</head>

<body>

<div class="left-panel" id="playerArea">
    <button id="togglePlaylistBtn">‚ò∞</button> 

    <div class="disc-container" id="disc"></div>

    <div class="song-title" id="songTitle">ƒêang t·∫£i...</div>
    <div class="song-desc" id="songDesc"></div>
    
    <div class="progress-container">
        <div class="progress-bar" id="progressBar">
            <div class="progress" id="progress"></div>
        </div>
        <div class="time-display">
            <span id="currentTime">0:00</span>
            <span id="durationTime">0:00</span>
        </div>
    </div>
    <div class="controls">
        <button class="btn" id="prevBtn">‚èÆ</button>
        <button class="btn" id="shuffleBtn">üîÄ</button>
        <button class="btn" id="playBtn">‚ñ∂Ô∏è</button>
        <button class="btn" id="shareBtn">üîó</button>
        <button class="btn" id="nextBtn">‚è≠</button>
    </div>

</div>

<div class="playlist" id="playlist">
    <h2>Danh S√°ch B√†i H√°t</h2>
    <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm t√™n b√†i h√°t ho·∫∑c t√°c gi·∫£..." onkeyup="filterSongs()" style="
        width: 95%; 
        padding: 10px; 
        margin-bottom: 20px; 
        border: none; 
        border-radius: 5px; 
        background: rgba(255, 255, 255, 0.1); 
        color: white; 
        font-size: 14px;
    ">
</div>

<audio id="audio"></audio>

<script>
// *** KHAI B√ÅO D·ªÆ LI·ªÜU G·ªêC V√Ä THI·∫æT L·∫¨P L∆ØU TR·ªÆ C·ª§C B·ªò ***
const STORAGE_KEY = 'kangthy_music_playlist';

// D·ªØ li·ªáu g·ªëc (ƒê√É TH√äM TR∆Ø·ªúNG 'cover')
// L∆ØU √ù: Vui l√≤ng thay th·∫ø 'url_anh_mac_dinh.jpg' v√† c√°c URL cover kh√°c b·∫±ng ·∫£nh c·ªßa b·∫°n.
let songs = [
    { title: "Ch√∫ng Ta", desc: "Lyrics: OneKang ‚Ä¢ Artist: BB.A", file: "Ch√∫ng ta _.mp3", playCount: 6.6225, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/02005d4f3bd9cdd96bb59add285779b40576b5ad/IMG_5366.JPG" }, 
    { title: "ƒê√™m D√†i", desc: "Lyrics: OneKang ‚Ä¢ Artist: QU√ÇNBy - OngKang - B·∫£o Black", file: "ƒê√™m D√†i.mp3", playCount: 6.6225, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/0826d9dfab0e06384ce5e135b70f81be636c0a0d/z7300307998090_e88f094681988496cd7448fdca2a6dcc.jpg" },
    { title: "Xu√¥i Theo D√≤ng", desc: "Lyrics: OneKang ‚Ä¢ Artist: Qu√¢nBy", file: "Xu√¥i theo s√¥ng.mp3", playCount: 1.123, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/ee11147f7324130dfdae739dea2204f5c7f63917/diaquay.jpg" },
    { title: "ƒê·ªì Ngon", desc: "Lyrics: OneKang ‚Ä¢ Artist: B·∫£o Black", file: "ƒê·ªì Ngon.mp3", playCount: 1.123, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/0826d9dfab0e06384ce5e135b70f81be636c0a0d/z7300307221612_0bb54ca8ddc8a81765d57b4ba9785d7f.jpg" },
    { title: "K√©o Anh T√¥i Ra", desc: "Lyrics: OneKang ‚Ä¢ Artist: Rick", file: "K√©o Anh T√¥i Ra.mp3", playCount: 2.124, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/8f816a23e19e9041c7cf71b11a907a864c34c03e/photo_2025-03-04_18-40-42.jpg" },
    { title: "Ch·∫°y Kh·ªèi Tao", desc: "Lyrics: OneKang ‚Ä¢ Artist: B·∫£o Black", file: "Ch·∫°y kh·ªèi tao.mp3", playCount: 3.329, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/ee11147f7324130dfdae739dea2204f5c7f63917/diaquay.jpg" },
    { title: "C√≤n Ngo·∫°i ƒê√¢u", desc: "Lyrics: OneKang ‚Ä¢ Artist: BB.A", file: "C√≤n ngo·∫°i ƒë√¢u _.mp3", playCount: 6.442, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/02005d4f3bd9cdd96bb59add285779b40576b5ad/z7280227127599_19b782c2166dab57ad1468f645d2f276.jpg" },
    { title: "Qu√™n Ngo·∫°i", desc: "Lyrics: OneKang ‚Ä¢ Artist: Qu√¢nBy", file: "Qu√™n Ngo·∫°i.mp3", playCount: 4.244, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/02005d4f3bd9cdd96bb59add285779b40576b5ad/z7280227127599_19b782c2166dab57ad1468f645d2f276.jpg" },
    { title: "Sao Em L·∫°i Ch·ªçn Kh√≥ KhƒÉn", desc: "Lyrics: OneKang ‚Ä¢ Artist: ƒê·∫°iTo", file: "Sao em l·∫°i ch·ªçn kh√≥ khƒÉn _.mp3", playCount: 6.122, cover: "https://raw.githubusercontent.com/huukhanh2612/kangthy/02005d4f3bd9cdd96bb59add285779b40576b5ad/IMG_5366.JPG" }
];

let currentSong = 0;

const audio = document.getElementById("audio");
const songTitle = document.getElementById("songTitle");
const songDesc = document.getElementById("songDesc");
const playerArea = document.getElementById("playerArea");
const playlistEl = document.getElementById("playlist");
const playBtn = document.getElementById("playBtn");
// KHAI B√ÅO DISC M·ªöI
const discEl = document.getElementById("disc"); 

const progressBar = document.getElementById("progressBar");
const progress = document.getElementById("progress");
const currentTimeEl = document.getElementById("currentTime");
const durationTimeEl = document.getElementById("durationTime");

const togglePlaylistBtn = document.getElementById("togglePlaylistBtn");
const shuffleBtn = document.getElementById("shuffleBtn"); 
// TH√äM: N√∫t Chia s·∫ª
const shareBtn = document.getElementById("shareBtn");


// --- H√ÄM H·ªñ TR·ª¢ ƒê·ªäNH D·∫†NG TH·ªúI GIAN ---
function formatTime(seconds) {
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60);
    return `${min}:${sec < 10 ? '0' : ''}${sec}`;
}
// ------------------------------------

// --- LOGIC L∆ØU TR·ªÆ LOCAL STORAGE CHO L∆Ø·ª¢T NGHE (Gi·ªØ nguy√™n) ---
function loadSongsFromStorage() {
    const storedData = localStorage.getItem(STORAGE_KEY);
    if (storedData) {
        const storedSongs = JSON.parse(storedData);
        songs = songs.map(defaultSong => {
            const storedSong = storedSongs.find(s => s.title === defaultSong.title);
            if (storedSong) {
                // Gi·ªØ l·∫°i cover m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥ trong storage
                return { ...defaultSong, playCount: storedSong.playCount };
            }
            return defaultSong;
        });
    }
}

function saveSongsToStorage() {
    const dataToStore = songs.map(song => ({
        title: song.title,
        playCount: song.playCount
    }));
    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToStore));
}
// --------------------------------------------------

// H√†m l·ªçc b√†i h√°t theo ti√™u ƒë·ªÅ ho·∫∑c t√°c gi·∫£ (ƒê√É KH·∫ÆC PH·ª§C L·ªñI HI·ªÇN TH·ªä CSS)
function filterSongs() {
    const input = document.getElementById("searchInput").value.toLowerCase();
    const songItems = document.querySelectorAll(".song-item");

    songItems.forEach((item, index) => {
        const songData = songs[index];
        const textToSearch = (songData.title + " " + songData.desc).toLowerCase();

        if (textToSearch.includes(input)) {
            // KH·∫ÆC PH·ª§C: S·ª≠ d·ª•ng 'flex' ƒë·ªÉ hi·ªÉn th·ªã song-item
            item.style.display = "flex"; 
        } else {
            item.style.display = "none";
        }
    });
}

// TƒÉng l∆∞·ª£t nghe v√† l∆∞u tr·ªØ (Gi·ªØ nguy√™n)
function incrementPlayCount(index) {
    if (songs[index]) {
        // L√†m tr√≤n l∆∞·ª£t nghe th√†nh s·ªë nguy√™n tr∆∞·ªõc khi l∆∞u
        songs[index].playCount = Math.round((songs[index].playCount || 0) + 1); 
        saveSongsToStorage(); 
        updatePlaylistDisplay(); 
    }
}

// C·∫¨P NH·∫¨T: Th√™m tham s·ªë shouldPlay ƒë·ªÉ ki·ªÉm so√°t vi·ªác ph√°t
function loadSong(index, shouldPlay = true) {
    currentSong = index;
    const songData = songs[index];
    
    // C·∫¨P NH·∫¨T QUAN TR·ªåNG: Thay ƒë·ªïi ·∫£nh n·ªÅn c·ªßa ƒëƒ©a quay
    discEl.style.backgroundImage = `url('${songData.cover}')`;
    
    audio.src = songData.file;
    songTitle.textContent = songData.title;
    songDesc.textContent = songData.desc;
    
    // ƒê·∫£m b·∫£o n√∫t play ƒë∆∞·ª£c c·∫≠p nh·∫≠t ƒë√∫ng icon V√Ä t·ª± ƒë·ªông ph√°t n·∫øu c·∫ßn
    if (shouldPlay) {
        audio.play(); 
        playerArea.classList.add("playing");
        playBtn.textContent = '‚è∏Ô∏è'; 
    } else {
         audio.pause();
         playerArea.classList.remove("playing");
         playBtn.textContent = '‚ñ∂Ô∏è';
         audio.currentTime = 0; // ƒê·∫∑t v·ªÅ ƒë·∫ßu b√†i
    }

    updatePlaylist();
}

function updatePlaylist() {
    document.querySelectorAll(".song-item").forEach((item, i) => {
        item.classList.toggle("active", i === currentSong);
    });
}

// C·∫≠p nh·∫≠t l·∫°i giao di·ªán playlist (ƒê√É TH√äM N√öT SHARE NH·ªé)
function updatePlaylistDisplay() {
    // KH·∫ÆC PH·ª§C: X√≥a t·∫•t c·∫£ song-item c≈© tr·ª´ input t√¨m ki·∫øm v√† ti√™u ƒë·ªÅ
    const songItemsToRemove = document.querySelectorAll("#playlist .song-item");
    songItemsToRemove.forEach(item => item.remove());

    songs.forEach((song, i) => {
        const div = document.createElement("div");
        div.className = "song-item";
        
        // L√†m tr√≤n playCount khi hi·ªÉn th·ªã
        const roundedPlayCount = Math.round(song.playCount || 0); 

        div.innerHTML = `
            <div class="song-details">
                <div class="song-name">${song.title}</div>
                <div class="song-info">${song.desc}</div>
                <div class="song-stats">L∆∞·ª£t nghe: ${roundedPlayCount}</div>
            </div>
            <button class="share-playlist-btn" onclick="handleShare(${i}, event)">üîó</button> 
        `;
        
        div.onclick = (e) => {
            // ƒê·∫£m b·∫£o kh√¥ng load b√†i khi click v√†o n√∫t share
            if (e.target.classList.contains('share-playlist-btn')) return;
            loadSong(i);
        };
        playlistEl.appendChild(div);
    });

    updatePlaylist(); 
    filterSongs();
}

// LOGIC CHO N√öT ·∫®N/HI·ªÜN PLAYLIST (Gi·ªØ nguy√™n)
togglePlaylistBtn.onclick = () => {
    playlistEl.classList.toggle('hidden');
    playerArea.classList.toggle('full-width');
    
    if (playlistEl.classList.contains('hidden')) {
        togglePlaylistBtn.innerHTML = '‚ñ∂Ô∏è'; 
    } else {
        togglePlaylistBtn.innerHTML = '‚ò∞'; 
    }
};

// LOGIC TR·ªòN B√ÄI (SHUFFLE) (Gi·ªØ nguy√™n)
function shuffleSongs() {
    for (let i = songs.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [songs[i], songs[j]] = [songs[j], songs[i]];
    }
    // G·ªëc: loadSong(0)
    // C·∫≠p nh·∫≠t: ch·ªâ c·∫≠p nh·∫≠t playlist, vi·ªác load b√†i ƒë·∫ßu ti√™n ƒë∆∞·ª£c x·ª≠ l√Ω trong checkUrlForShare
    // Tuy nhi√™n, ƒë·ªÉ gi·ªØ ƒë√∫ng h√†nh vi ban ƒë·∫ßu, ta g·ªçi updatePlaylistDisplay() sau.
    updatePlaylistDisplay(); 
}

// B·∫•m n√∫t Tr·ªôn b√†i
shuffleBtn.onclick = () => {
    if (!audio.paused) incrementPlayCount(currentSong); 
    shuffleSongs();
    loadSong(0); // T·ª± ƒë·ªông ph√°t b√†i ƒë·∫ßu ti√™n sau khi tr·ªôn
};
// --------------------------------------

// *** TH√äM LOGIC CHIA S·∫∫ LINK B√ÄI H√ÅT ***

// H√†m x·ª≠ l√Ω vi·ªác chia s·∫ª
function handleShare(index, event) {
    if (event) event.stopPropagation(); // NgƒÉn s·ª± ki·ªán click lan truy·ªÅn l√™n song-item

    const songData = songs[index || currentSong];
    
    // M√£ h√≥a t√™n b√†i h√°t ƒë·ªÉ ƒë∆∞a v√†o URL
    const encodedTitle = encodeURIComponent(songData.title);
    
    // L·∫•y URL hi·ªán t·∫°i v√† th√™m tham s·ªë song
    const shareUrl = `${window.location.origin}${window.location.pathname}?song=${encodedTitle}`;
    
    // Sao ch√©p v√†o clipboard
    if (navigator.clipboard) {
        navigator.clipboard.writeText(shareUrl).then(() => {
            alert(`ƒê√£ sao ch√©p li√™n k·∫øt b√†i h√°t '${songData.title}' v√†o clipboard!`);
        }).catch(err => {
            console.error('Kh√¥ng th·ªÉ sao ch√©p URL: ', err);
            alert('L·ªói: Kh√¥ng th·ªÉ sao ch√©p li√™n k·∫øt. Vui l√≤ng th·ª≠ l·∫°i.');
        });
    } else {
         // Fallback cho tr√¨nh duy·ªát c≈©
        alert(`Li√™n k·∫øt b√†i h√°t: ${shareUrl}`);
    }
}

// Ki·ªÉm tra URL khi t·∫£i trang ƒë·ªÉ t·∫£i b√†i h√°t ƒë∆∞·ª£c chia s·∫ª
function checkUrlForShare() {
    const urlParams = new URLSearchParams(window.location.search);
    const sharedSongTitle = urlParams.get('song');

    if (sharedSongTitle) {
        // Gi·∫£i m√£ t√™n b√†i h√°t
        const decodedTitle = decodeURIComponent(sharedSongTitle);
        
        // T√¨m index c·ªßa b√†i h√°t
        const index = songs.findIndex(song => song.title === decodedTitle);

        if (index !== -1) {
            // T·∫£i b√†i h√°t ƒë∆∞·ª£c chia s·∫ª v√† T·ª∞ ƒê·ªòNG PH√ÅT (h√†nh vi mong mu·ªën)
            loadSong(index, true); 
            return true;
        }
    }
    return false;
}


// --- Kh·ªüi t·∫°o v√† Buttons ---

loadSongsFromStorage(); 
shuffleSongs(); // Tr·ªôn b√†i
// KI·ªÇM TRA: N·∫øu kh√¥ng c√≥ b√†i h√°t chia s·∫ª trong URL, h√£y t·∫£i b√†i ƒë·∫ßu ti√™n v√† t·ª± ƒë·ªông ph√°t nh∆∞ code g·ªëc
if (!checkUrlForShare()) {
    loadSong(0); 
}


// Buttons (Gi·ªØ nguy√™n)
playBtn.onclick = () => {
    if (audio.paused) {
        audio.play();
        playerArea.classList.add("playing");
        playBtn.textContent = '‚è∏Ô∏è';
    } else {
        audio.pause();
        playerArea.classList.remove("playing");
        playBtn.textContent = '‚ñ∂Ô∏è';
    }
};

// TH√äM: G√°n h√†m handleShare v√†o n√∫t Chia s·∫ª l·ªõn
shareBtn.onclick = () => handleShare(currentSong);


document.getElementById("nextBtn").onclick = () => {
    if (!audio.paused) incrementPlayCount(currentSong); 
    currentSong = (currentSong + 1) % songs.length;
    loadSong(currentSong);
};

document.getElementById("prevBtn").onclick = () => {
    if (!audio.paused) incrementPlayCount(currentSong);
    currentSong = (currentSong - 1 + songs.length) % songs.length;
    loadSong(currentSong);
};

// *** LOGIC CHO THANH TI·∫æN TR√åNH (Gi·ªØ nguy√™n) ***
audio.ontimeupdate = function() {
    const duration = audio.duration;
    const currentTime = audio.currentTime;
    
    if (duration > 0) {
        const progressPercent = (currentTime / duration) * 100;
        progress.style.width = progressPercent + '%';
        currentTimeEl.textContent = formatTime(currentTime);
    }
};

audio.onloadedmetadata = function() {
    durationTimeEl.textContent = formatTime(audio.duration);
};

progressBar.onclick = function(e) {
    const width = this.clientWidth; 
    const clickX = e.offsetX; 
    const duration = audio.duration;
    
    audio.currentTime = (clickX / width) * duration;
};


// T·ª± chuy·ªÉn b√†i v√† tƒÉng l∆∞·ª£t nghe khi b√†i h√°t k·∫øt th√∫c
audio.onended = () => {
    incrementPlayCount(currentSong); 
    currentSong = (currentSong + 1) % songs.length;
    loadSong(currentSong);
};
</script>

</body>
</html>
